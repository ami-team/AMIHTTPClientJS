/*!
 * AMI HTTP Client 1.0.0
 *
 * Copyright © 2021-2022 CNRS/LPSC
 *
 * Author: Jérôme ODIER (jerome.odier@lpsc.in2p3.fr)
 *
 * Repositories: https://gitlab.in2p3.fr/ami-team/AMIHTTPClientJS/
 *               https://www.github.com/ami-team/AMIHTTPClientJS/
 *
 * This software is a computer program whose purpose is to provide an
 * HTTP Client to the ATLAS Metadata Interface (AMI) ecosystem.
 *
 * This software is governed by the CeCILL-C license under French law and
 * abiding by the rules of distribution of free software. You can use,
 * modify and/or redistribute the software under the terms of the CeCILL-C
 * license as circulated by CEA, CNRS and INRIA at the following URL
 * "http://www.cecill.info".
 *
 * The fact that you are presently reading this means that you have had
 * knowledge of the CeCILL-C license and that you accept its terms.
 *
 */(()=>{var e={915:(e,t,n)=>{e.exports=n(583)},583:(e,t,n)=>{"use strict";var r;!function(){var o=1,u=2,i=3,a=4,s=5,c=6,f=7,l=8,p=9,h=10,y=11,v=function(){var e,t,n,r,v=1,g=2,d=3,w=4,b=5,m=6,x=7,j='Unexpected token "%0"',O="Unexpected end of path";function A(){for(var e,t=I();U("|");)G(),(e||(e=[t])).push(I());return e?{type:l,args:e}:t}function I(){return U("(")?k():P()}function k(){W("(");var e=A();W(")");for(var t,n=[];t=S();)n.push(t);return n.length?e.type===o?(e.parts=e.parts.concat(n),e):(n.unshift(e),{type:o,parts:n}):e}function S(){return U("[")?function(){W("[");var e=function(){if(U(":"))return G(),{type:h,toIdx:N()};var e=N();if(U(":"))return G(),U("]")?{type:h,fromIdx:e}:{type:h,fromIdx:e,toIdx:N()};return{type:h,idx:e}}();return W("]"),{type:a,arg:e}}():U("{")?function(){W("{");var e=M();return W("}"),{type:i,arg:e}}():U("(")?k():void 0}function P(){_()||Z(G());var e,t=!1;U("^")?(G(),t=!0):L()&&(e=G().val.substr(1));for(var n,r=[];n=D()?function(){var e,t=G().val,n=z();(U("*")||n.type===v||n.type===d)&&(e=G().val);return{type:u,selector:t,prop:e}}():S();)r.push(n);return{type:o,fromRoot:t,subst:e,parts:r}}function M(){for(var e,t=$();U("||");)G(),(e||(e=[t])).push($());return e?{type:s,op:"||",args:e}:t}function $(){for(var e,t=C();U("&&");)G(),(e||(e=[t])).push(C());return e?{type:s,op:"&&",args:e}:t}function C(){for(var e=T();U("==")||U("!=")||U("===")||U("!==")||U("^==")||U("==^")||U("^=")||U("=^")||U("$==")||U("==$")||U("$=")||U("=$")||U("*==")||U("==*")||U("*=")||U("=*");)e={type:c,op:G().val,args:[e,C()]};return e}function T(){for(var e=function(){var e=E();for(;U("+")||U("-");)e={type:f,op:G().val,args:[e,E()]};return e}();U("<")||U(">")||U("<=")||U(">=");)e={type:c,op:G().val,args:[e,T()]};return e}function E(){for(var e=N();U("*")||U("/")||U("%");)e={type:f,op:G().val,args:[e,E()]};return e}function N(){return U("!")||U("-")?{type:p,op:G().val,arg:N()}:function(){var e=z().type;if(e===d||e===g||e===w||e===b)return{type:y,val:G().val};if(_())return P();if(U("("))return function(){W("(");var e=M();return W(")"),e}();return Z(G())}()}function U(e){var t=z();return t.type===m&&t.val===e}function _(){return D()||L()||U("^")}function D(){var e=z();if(e.type===m){var t=e.val;return"."===t||".."===t}return!1}function L(){var e=z();return e.type===v&&"$"===e.val[0]}function W(e){var t=G();t.type===m&&t.val===e||Z(t)}function z(){if(null!==n)return n;var e=t;return n=B(),t=e,n}function B(){for(;n=e[t]," \r\n\t".indexOf(n)>-1;)++t;var n;if(t>=r)return{type:x,range:[t,t]};var o=function(){var n=t,r=e[t],o=e[t+1];if("."===r){if(R(o))return;return"."===e[++t]?{type:m,val:"..",range:[n,++t]}:{type:m,val:".",range:[n,t]}}if("="===o){var u=e[t+2];if("="===u){if("=!^$*".indexOf(r)>=0)return{type:m,val:r+o+u,range:[n,t+=3]}}else if("^$*".indexOf(u)>=0){if("="===r)return{type:m,val:r+o+u,range:[n,t+=3]}}else if("=!^$*><".indexOf(r)>=0)return{type:m,val:r+o,range:[n,t+=2]}}else if("="===r&&"^$*".indexOf(o)>=0)return{type:m,val:r+o,range:[n,t+=2]};if(r===o&&("|"===r||"&"===r))return{type:m,val:r+o,range:[n,t+=2]};if(":{}()[]^+-*/%!><|".indexOf(r)>=0)return{type:m,val:r,range:[n,++t]}}();if(o||(o=function(){var n=e[t];if(!F(n))return;var o=t,u=n;for(;++t<r&&J(n=e[t]);)u+=n;switch(u){case"true":case"false":return{type:w,val:"true"===u,range:[o,t]};case"null":return{type:b,val:null,range:[o,t]};default:return{type:v,val:u,range:[o,t]}}}())||(o=function(){if('"'!==e[t]&&"'"!==e[t])return;var n,o=e[t],u=++t,i="",a=!1;for(;t<r;){if("\\"===(n=e[t++]))n=e[t++];else if(('"'===n||"'"===n)&&n===o){a=!0;break}i+=n}if(a)return{type:d,val:i,range:[u,t]}}())||(o=function(){var n=t,o=e[t],u="."===o;if(u||R(o)){for(var i=o;++t<r;){if("."===(o=e[t])){if(u)return;u=!0}else if(!R(o))break;i+=o}return{type:g,val:u?parseFloat(i):parseInt(i,10),range:[n,t]}}}()))return o;o={range:[t,t]},t>=r?o.type=x:o.val=e[t],Z(o)}function G(){var e;return n?(t=n.range[1],e=n,n=null,e):B()}function R(e){return"0123456789".indexOf(e)>=0}function F(e){return"$"===e||"@"===e||"_"===e||e>="a"&&e<="z"||e>="A"&&e<="Z"}function J(e){return F(e)||e>="0"&&e<="9"}function Z(e){e.type===x&&X(e,O),X(e,j,e.val)}function X(e,t){var n=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(function(e,t){return n[t]||""})),o=new Error(r);throw o.column=e.range[0],o}return function(o){e=o.split(""),t=0,n=null,r=e.length;var u=A(),i=G();return i.type!==x&&Z(i),u}}(),g=function(){var e,t,n,r;function h(){if(r.length)return r.shift();var e="v"+ ++n;return t.push(e),e}function v(){for(var e=arguments,t=e.length;t--;)r.push(e[t])}function g(t,n,r){if(t.prop){var o=O(t.prop),u=h(),i=h(),a=h(),s=h(),c=h(),f=h(),l=h();e.push(u,"= [];",i,"= 0;",a,"=",r,".length;",l,"= [];","while(",i,"<",a,") {",s,"=",r,"[",i,"++];","if(",s,"!= null) {"),"*"===t.prop?(e.push("if(typeof ",s,'=== "object") {',"if(isArr(",s,")) {",u,"=",u,".concat(",s,");","}","else {","for(",c," in ",s,") {","if(",s,".hasOwnProperty(",c,")) {",f,"=",s,"[",c,"];"),A(u,f),e.push("}","}","}","}")):(e.push(f,"=",s,"[",o,"];"),A(u,f,l,a)),e.push("}","}",n,"=",a,"> 1 &&",l,".length?",l,".length > 1?","concat.apply(",u,",",l,") :",u,".concat(",l,"[0]) :",u,";"),v(u,i,a,s,c,f,l)}}function d(t,n,r){var o=t.prop,u=h(),i=h(),a=h(),s=h(),c=h(),f=h(),l=h(),p=h();e.push(u,"=",r,".slice(),",p,"= [];","while(",u,".length) {",i,"=",u,".shift();"),o?e.push("if(typeof ",i,'=== "object" &&',i,") {"):e.push("if(typeof ",i,"!= null) {"),e.push(a,"= [];","if(isArr(",i,")) {",s,"= 0,",l,"=",i,".length;","while(",s,"<",l,") {",f,"=",i,"[",s,"++];"),o&&e.push("if(typeof ",f,'=== "object") {'),A(a,f),o&&e.push("}"),e.push("}","}","else {"),o?"*"!==o&&(e.push(f,"=",i,'["'+o+'"];'),A(p,f)):(A(p,i),e.push("if(typeof ",i,'=== "object") {')),e.push("for(",c," in ",i,") {","if(",i,".hasOwnProperty(",c,")) {",f,"=",i,"[",c,"];"),A(a,f),"*"===o&&A(p,f),e.push("}","}"),o||e.push("}"),e.push("}",a,".length &&",u,".unshift.apply(",u,",",a,");","}","}",n,"=",p,";"),v(u,i,a,s,c,f,l,p)}function w(t,n,r){var o=h(),u=h(),i=h(),a=h(),s=h();e.push(o,"= [];",u,"= 0;",i,"=",r,".length;","while(",u,"<",i,") {",s,"=",r,"[",u,"++];"),m(t.arg,a,s),e.push(k(t.arg,a),"&&",o,".push(",s,");","}",n,"=",o,";"),v(o,u,i,s,a)}function b(t,n,r){var o,u,i=t.arg;if(i.idx){var a=h();return m(i.idx,a,r),e.push(a,"< 0 && (",a,"=",r,".length +",a,");",n,"=",r,"[",a,"] == null? [] : [",r,"[",a,"]];"),v(a),!1}i.fromIdx?i.toIdx?(m(i.fromIdx,o=h(),r),m(i.toIdx,u=h(),r),e.push(n,"=",r,".slice(",o,",",u,");"),v(o,u)):(m(i.fromIdx,o=h(),r),e.push(n,"=",r,".slice(",o,");"),v(o)):(m(i.toIdx,u=h(),r),e.push(n,"=",r,".slice(0,",u,");"),v(u))}function m(t,n,r){switch(t.type){case o:!function(t,n,r){var o=t.parts,s=0,c=o.length;for(e.push(n,"=",t.fromRoot?"data":t.subst?"subst."+t.subst:r,";","isArr("+n+") || ("+n+" = ["+n+"]);");s<c;){var f=o[s++];switch(f.type){case u:".."===f.selector?d(f,n,n):g(f,n,n);break;case i:w(f,n,n);break;case a:b(f,n,n);break;case l:j(f,n,n)}}}(t,n,r);break;case l:j(t,n,r);break;case c:!function(t,n,r){var u=h(),i=h(),a=h(),s=h(),c=h(),f=h(),l=h(),p=h(),g=t.args[0],d=t.args[1];e.push(n,"= false;"),m(g,u,r),m(d,i,r);var w=g.type===o,b=d.type===y;e.push(a,"="),w?e.push("true;"):e.push("isArr(",u,");"),e.push(s,"="),b?e.push("false;"):e.push("isArr(",i,");"),e.push("if("),w||e.push(a,"&&"),e.push(u,".length === 1) {",u,"=",u,"[0];",a,"= false;","}"),b||e.push("if(",s,"&&",i,".length === 1) {",i,"=",i,"[0];",s,"= false;","}"),e.push(c,"= 0;","if(",a,") {",l,"=",u,".length;"),b||(e.push("if(",s,") {",p,"=",i,".length;","while(",c,"<",l,"&& !",n,") {",f,"= 0;","while(",f,"<",p,") {"),x(t.op,[u,"[",c,"]"].join(""),[i,"[",f,"]"].join("")),e.push(n,"= true;","break;","}","++",f,";","}","++",c,";","}","}","else {"));e.push("while(",c,"<",l,") {"),x(t.op,[u,"[",c,"]"].join(""),i),e.push(n,"= true;","break;","}","++",c,";","}"),b||e.push("}"),e.push("}"),b||(e.push("else if(",s,") {",p,"=",i,".length;","while(",c,"<",p,") {"),x(t.op,u,[i,"[",c,"]"].join("")),e.push(n,"= true;","break;","}","++",c,";","}","}"));e.push("else {",n,"=",N[t.op](u,i),";","}"),v(u,i,a,s,c,f,l,p)}(t,n,r);break;case f:!function(t,n,r){var o=h(),u=h(),i=t.args;m(i[0],o,r),m(i[1],u,r),e.push(n,"=",N[t.op](S(i[0],o),S(i[1],u)),";"),v(o,u)}(t,n,r);break;case s:!function(t,n,r){var o,u=[],i=t.args,a=i.length,s=0;switch(e.push(n,"= false;"),t.op){case"&&":for(;s<a;)u.push(o=h()),m(i[s],o,r),e.push("if(",k(i[s++],o),") {");e.push(n,"= true;");break;case"||":for(;s<a;)u.push(o=h()),m(i[s],o,r),e.push("if(",k(i[s],o),") {",n,"= true;","}"),1+s++<a&&e.push("else {");--a}for(;a--;)e.push("}");v.apply(null,u)}(t,n,r);break;case p:!function(t,n,r){var o=h(),u=t.arg;switch(m(u,o,r),t.op){case"!":e.push(n,"= !",k(u,o)+";");break;case"-":e.push(n,"= -",S(u,o)+";")}v(o)}(t,n,r);break;case y:e.push(n,"="),A=t.val,e.push("string"==typeof A?O(A):null===A?"null":A),e.push(";")}var A}function x(t,n,r){e.push("if(",N[t](n,r),") {")}function j(t,n,r){for(var o=[],u=t.args,i=u.length,a=0;a<i;)o.push(h()),m(u[a],o[a++],r);e.push(n,"= concat.call(",o.join(","),");"),v.apply(null,o)}function O(e){return"'"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"}function A(t,n,r,o){e.push("if(typeof ",n,'!== "undefined") {',"if(isArr(",n,")) {"),r&&(e.push(o,"> 1?"),I(r,n),e.push(":")),e.push(t,"=",t,".length?",t,".concat(",n,") :",n,".slice()",";","}","else {"),r&&e.push("if(",r,".length) {",t,"= concat.apply(",t,",",r,");",r,"= [];","}"),I(t,n),e.push(";","}","}")}function I(t,n){e.push(t,".length?",t,".push(",n,") :",t,"[0] =",n)}function k(e,t){switch(e.type){case s:return t;case y:return"!!"+t;case o:return t+".length > 0";default:return["(typeof ",t,'=== "boolean"?',t,":","isArr(",t,")?",t,".length > 0 : !!",t,")"].join("")}}function S(e,t){switch(e.type){case y:return t;case o:return t+"[0]";default:return["(isArr(",t,")?",t,"[0] : ",t,")"].join("")}}function P(e,t){return["typeof ",e,'=== "string" && typeof ',t,'=== "string" &&',e,".indexOf(",t,") === 0"].join("")}function M(e,t){return[e,"!= null &&",t,"!= null &&",e,".toString().toLowerCase().indexOf(",t,".toString().toLowerCase()) === 0"].join("")}function $(e,t){return["typeof ",e,'=== "string" && typeof ',t,'=== "string" &&',e,".length >=",t,".length &&",e,".lastIndexOf(",t,") ===",e,".length -",t,".length"].join("")}function C(e,t){return[e,"!= null &&",t,"!= null &&","(",e,"=",e,".toString()).length >=","(",t,"=",t,".toString()).length &&","(",e,".toLowerCase()).lastIndexOf(","(",t,".toLowerCase())) ===",e,".length -",t,".length"].join("")}function T(e,t){return["typeof ",e,'=== "string" && typeof ',t,'=== "string" &&',e,".indexOf(",t,") > -1"].join("")}function E(e,t){return[e,"!= null && ",t,"!= null &&",e,".toString().toLowerCase().indexOf(",t,".toString().toLowerCase()) > -1"].join("")}var N={"===":function(e,t){return e+"==="+t},"==":function(e,t){return["typeof ",e,'=== "string" && typeof ',t,'=== "string"?',e,".toLowerCase() ===",t,".toLowerCase() :"+e,"==",t].join("")},">=":function(e,t){return e+">="+t},">":function(e,t){return e+">"+t},"<=":function(e,t){return e+"<="+t},"<":function(e,t){return e+"<"+t},"!==":function(e,t){return e+"!=="+t},"!=":function(e,t){return e+"!="+t},"^==":P,"==^":function(e,t){return P(t,e)},"^=":M,"=^":function(e,t){return M(t,e)},"$==":$,"==$":function(e,t){return $(t,e)},"$=":C,"=$":function(e,t){return C(t,e)},"*==":T,"==*":function(e,t){return T(t,e)},"=*":function(e,t){return E(t,e)},"*=":E,"+":function(e,t){return e+"+"+t},"-":function(e,t){return e+"-"+t},"*":function(e,t){return e+"*"+t},"/":function(e,t){return e+"/"+t},"%":function(e,t){return e+"%"+t}};return function(u){if(e=[],t=["res"],n=0,r=[],m(u,"res","data"),e.unshift("var ",Array.isArray?"isArr = Array.isArray":'toStr = Object.prototype.toString, isArr = function(o) { return toStr.call(o) === "[object Array]"; }',", concat = Array.prototype.concat",",",t.join(","),";"),u.type===o){var i=u.parts[u.parts.length-1];i&&i.type===a&&"idx"in i.arg&&e.push("res = res[0];")}return e.push("return res;"),e.join("")}}();function d(e){return Function("data,subst",g(v(e)))}var w={},b=[],m={cacheSize:100},x={cacheSize:function(e,t){if(t<e&&b.length>t)for(var n=b.splice(0,b.length-t),r=n.length;r--;)delete w[n[r]]}},j=function(e,t,n){return w[e]||(w[e]=d(e),b.push(e)>m.cacheSize&&delete w[b.shift()]),w[e](t,n||{})};j.version="0.3.4",j.params=function(e){if(!arguments.length)return m;for(var t in e)e.hasOwnProperty(t)&&(x[t]&&x[t](m[t],e[t]),m[t]=e[t])},j.compile=d,j.apply=j,"object"==typeof e.exports?e.exports=j:"object"==typeof modules?modules.define("jspath",(function(e){e(j)})):(r=function(e,t,n){n.exports=j}.call(t,n,t,e),void 0===r||(e.exports=r))}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var u=t[r]={exports:{}};return e[r](u,u.exports,n),u.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(915),t=n.n(e);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,u=[],i=!0,a=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(u.push(r.value),!t||u.length!==t);i=!0);}catch(e){a=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(a)throw o}}return u}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){s(e,t),t.set(e,n)}function s(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function l(e,t,n){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),n}function p(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,y(e,t,"get"))}function h(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,y(e,t,"set"),n),n}function y(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var v=new WeakMap,g=new WeakMap,d=new WeakMap,w=new WeakMap,b=new WeakSet,m=function(){function e(t){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(n=this,r=b),r.add(n),c(this,"version","1.0.0"),a(this,v,{writable:!0,value:""}),a(this,g,{writable:!0,value:"AMIXmlToJson.xsl"}),a(this,d,{writable:!0,value:new RegExp("-\\W*([a-zA-Z][a-zA-Z0-9]*)\\W*=\\W*\\?","g")}),a(this,w,{writable:!0,value:"resource temporarily unreachable"}),h(this,v,t)}var n,o,y;return n=e,o=[{key:"getEndpoint",value:function(){return p(this,v)}},{key:"execute",value:function(n,o){var i=this,a=((o=o||{}).endpoint||p(this,v)).trim(),s=(o.converter||p(this,g)).trim(),f=o.extras||{},h=o.params||[],y=o.timeout||12e4,b=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({Command:n=(n||"").trim().replace(p(this,d),(function(e,t){var n=h.shift();return"[object String]"===Object.prototype.toString.call(n)?"-".concat(t,"=").concat(JSON.stringify(n)):"-".concat(t,'="').concat(JSON.stringify(n),'"')})),Converter:s},f),m=Object.entries(b).map((function(e){var t=r(e,2),n=t[0],o=t[1];return"".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(o))})).join("&"),j=a,O=a+"?"+m;return new Promise((function(n,r){if("AMIXmlToJson.xsl"===s){var o=!0,u=setTimeout((function(){r([l(e,e,x).call(e,"timeout"),"timeout",O]),o=!1}),y);fetch(j,{body:m,method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},credentials:"include",cache:"no-cache",mode:"cors"}).finally((function(){clearTimeout(u)})).then((function(u){o&&u.json().then((function(e){var o=t().apply(".AMIMessage.info.$",e),u=t().apply(".AMIMessage.error.$",e);0===u.length?n([e,o.join(". "),O]):r([e,u.join(". "),O])})).catch((function(){r([l(e,e,x).call(e,p(i,w)),p(i,w),O])}))})).catch((function(){o&&r([l(e,e,x).call(e,p(i,w)),p(i,w),O])}))}else{var a=!0,c=setTimeout((function(){r(["timeout","timeout",O]),a=!1}),y);fetch(j,{body:m,method:"POST",headers:{Accept:"text/plain","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},credentials:"include",cache:"no-cache",mode:"cors"}).finally((function(){clearTimeout(c)})).then((function(e){a&&e.text().then((function(e){n([e,e,O])})).catch((function(){r([p(i,w),p(i,w),O])}))})).catch((function(){a&&r([p(i,w),p(i,w),O])}))}}))}},{key:"signInByCode",value:function(e,t){return(t=t||{}).extras={NoCert:null},t.params=[e],f(this,b,O).call(this,this.execute('GetSessionInfo -AMIUser="__oidc_code__" -AMIPass=?',t))}},{key:"signInByToken",value:function(e,t){return(t=t||{}).extras={NoCert:null},t.params=[e],f(this,b,O).call(this,this.execute('GetSessionInfo -AMIUser="__oidc_token__" -AMIPass=?',t))}},{key:"signInByPassword",value:function(e,t,n){return(n=n||{}).extras={NoCert:null},n.params=[e,t],f(this,b,O).call(this,this.execute("GetSessionInfo -AMIUser=? -AMIPass=?",n))}},{key:"signInByCertificate",value:function(e){return(e=e||{}).extras={},e.params=[],f(this,b,O).call(this,this.execute("GetSessionInfo",e))}},{key:"signOut",value:function(e){return(e=e||{}).extras={NoCert:null},e.params=["",""],f(this,b,O).call(this,this.execute("GetSessionInfo -AMIUser=? -AMIPass=?",e))}},{key:"jspath",value:function(e,n){return t().apply(e,n)}}],o&&i(n.prototype,o),y&&i(n,y),Object.defineProperty(n,"prototype",{writable:!1}),e}();function x(e){return{AMIMessage:[{error:[{$:e}]}]}}function j(){return{AMIUser:"guest",guestUser:"guest",clientDNInAMI:"",issuerDNInAMI:"",clientDNInSession:"",issuerDNInSession:"",notBefore:"",notAfter:"",mqttToken:"",firstName:"guest",lastName:"guest",email:"N/A",country:"N/A",valid:"false"}}function O(e){return new Promise((function(n,o){e.then((function(e){var o=r(e,2),u=o[0],i=o[1],a={},s={},c={},f={},l={};t().apply('..rowset{.@type==="user"}.row.field',u).forEach((function(e){a[e["@name"]]=e.$})),t().apply('..rowset{.@type==="awf"}.row.field',u).forEach((function(e){l[e["@name"]]=e.$})),t().apply('..rowset{.@type==="role"}.row',u).forEach((function(e){var t="",n={};e.field.forEach((function(e){n[e["@name"]]=e.$,"name"===e["@name"]&&(t=e.$)})),s[t]=n})),t().apply('..rowset{.@type==="bookmark"}.row',u).forEach((function(e){var t="",n={};e.field.forEach((function(e){n[e["@name"]]=e.$,"hash"===e["@name"]&&(t=e.$)})),c[t]=n})),t().apply('..rowset{.@type==="dashboard"}.row',u).forEach((function(e){var t="",n={};e.field.forEach((function(e){n[e["@name"]]=e.$,"hash"===e["@name"]&&(t=e.$)})),f[t]=n})),n([u,i,a,s,c,f,l])})).catch((function(e,t){o([e,t,l(m,m,j).call(m),{},{},{},{}])}))}))}"undefined"!=typeof window&&(window.AMIHTTPClient=m)})()})();