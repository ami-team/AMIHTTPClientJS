/*!
 * Copyright © 2021-2021 CNRS/LPSC
 *
 * Author: Jérôme ODIER (jerome.odier@lpsc.in2p3.fr)
 *
 * Repositories: https://gitlab.in2p3.fr/ami-team/AMIHTTPClientJS/
 *               https://www.github.com/ami-team/AMIHTTPClientJS/
 *
 * This software is a computer program whose purpose is to provide an
 * HTTP Client to the ATLAS Metadata Interface (AMI) ecosystem.
 *
 * This software is governed by the CeCILL-C license under French law and
 * abiding by the rules of distribution of free software. You can use,
 * modify and/or redistribute the software under the terms of the CeCILL-C
 * license as circulated by CEA, CNRS and INRIA at the following URL
 * "http://www.cecill.info".
 *
 * The fact that you are presently reading this means that you have had
 * knowledge of the CeCILL-C license and that you accept its terms.
 *
 */(()=>{var r={915:(r,e,t)=>{r.exports=t(583)},583:(r,e,t)=>{"use strict";var n;!function(){var u=1,o=2,i=3,a=4,s=5,f=6,p=7,c=8,l=9,h=10,v=11,y=function(){var r,e,t,n,y=1,g=2,d=3,x=4,b=5,w=6,j=7,m='Unexpected token "%0"',A="Unexpected end of path";function O(){for(var r,e=$();z("|");)X(),(r||(r=[e])).push($());return r?{type:c,args:r}:e}function $(){return z("(")?k():C()}function k(){J("(");var r=O();J(")");for(var e,t=[];e=I();)t.push(e);return t.length?r.type===u?(r.parts=r.parts.concat(t),r):(t.unshift(r),{type:u,parts:t}):r}function I(){return z("[")?function(){J("[");var r=function(){if(z(":"))return X(),{type:h,toIdx:_()};var r=_();if(z(":"))return X(),z("]")?{type:h,fromIdx:r}:{type:h,fromIdx:r,toIdx:_()};return{type:h,idx:r}}();return J("]"),{type:a,arg:r}}():z("{")?function(){J("{");var r=S();return J("}"),{type:i,arg:r}}():z("(")?k():void 0}function C(){W()||Z(X());var r,e=!1;z("^")?(X(),e=!0):E()&&(r=X().val.substr(1));for(var t,n=[];t=F()?function(){var r,e=X().val,t=R();(z("*")||t.type===y||t.type===d)&&(r=X().val);return{type:o,selector:e,prop:r}}():I();)n.push(t);return{type:u,fromRoot:e,subst:r,parts:n}}function S(){for(var r,e=P();z("||");)X(),(r||(r=[e])).push(P());return r?{type:s,op:"||",args:r}:e}function P(){for(var r,e=M();z("&&");)X(),(r||(r=[e])).push(M());return r?{type:s,op:"&&",args:r}:e}function M(){for(var r=T();z("==")||z("!=")||z("===")||z("!==")||z("^==")||z("==^")||z("^=")||z("=^")||z("$==")||z("==$")||z("$=")||z("=$")||z("*==")||z("==*")||z("*=")||z("=*");)r={type:f,op:X().val,args:[r,M()]};return r}function T(){for(var r=function(){var r=L();for(;z("+")||z("-");)r={type:p,op:X().val,args:[r,L()]};return r}();z("<")||z(">")||z("<=")||z(">=");)r={type:f,op:X().val,args:[r,T()]};return r}function L(){for(var r=_();z("*")||z("/")||z("%");)r={type:p,op:X().val,args:[r,L()]};return r}function _(){return z("!")||z("-")?{type:l,op:X().val,arg:_()}:function(){var r=R().type;if(r===d||r===g||r===x||r===b)return{type:v,val:X().val};if(W())return C();if(z("("))return function(){J("(");var r=S();return J(")"),r}();return Z(X())}()}function z(r){var e=R();return e.type===w&&e.val===r}function W(){return F()||E()||z("^")}function F(){var r=R();if(r.type===w){var e=r.val;return"."===e||".."===e}return!1}function E(){var r=R();return r.type===y&&"$"===r.val[0]}function J(r){var e=X();e.type===w&&e.val===r||Z(e)}function R(){if(null!==t)return t;var r=e;return t=U(),e=r,t}function U(){for(;t=r[e]," \r\n\t".indexOf(t)>-1;)++e;var t;if(e>=n)return{type:j,range:[e,e]};var u=function(){var t=e,n=r[e],u=r[e+1];if("."===n){if(D(u))return;return"."===r[++e]?{type:w,val:"..",range:[t,++e]}:{type:w,val:".",range:[t,e]}}if("="===u){var o=r[e+2];if("="===o){if("=!^$*".indexOf(n)>=0)return{type:w,val:n+u+o,range:[t,e+=3]}}else if("^$*".indexOf(o)>=0){if("="===n)return{type:w,val:n+u+o,range:[t,e+=3]}}else if("=!^$*><".indexOf(n)>=0)return{type:w,val:n+u,range:[t,e+=2]}}else if("="===n&&"^$*".indexOf(u)>=0)return{type:w,val:n+u,range:[t,e+=2]};if(n===u&&("|"===n||"&"===n))return{type:w,val:n+u,range:[t,e+=2]};if(":{}()[]^+-*/%!><|".indexOf(n)>=0)return{type:w,val:n,range:[t,++e]}}();if(u||(u=function(){var t=r[e];if(!H(t))return;var u=e,o=t;for(;++e<n&&V(t=r[e]);)o+=t;switch(o){case"true":case"false":return{type:x,val:"true"===o,range:[u,e]};case"null":return{type:b,val:null,range:[u,e]};default:return{type:y,val:o,range:[u,e]}}}())||(u=function(){if('"'!==r[e]&&"'"!==r[e])return;var t,u=r[e],o=++e,i="",a=!1;for(;e<n;){if("\\"===(t=r[e++]))t=r[e++];else if(('"'===t||"'"===t)&&t===u){a=!0;break}i+=t}if(a)return{type:d,val:i,range:[o,e]}}())||(u=function(){var t=e,u=r[e],o="."===u;if(o||D(u)){for(var i=u;++e<n;){if("."===(u=r[e])){if(o)return;o=!0}else if(!D(u))break;i+=u}return{type:g,val:o?parseFloat(i):parseInt(i,10),range:[t,e]}}}()))return u;u={range:[e,e]},e>=n?u.type=j:u.val=r[e],Z(u)}function X(){var r;return t?(e=t.range[1],r=t,t=null,r):U()}function D(r){return"0123456789".indexOf(r)>=0}function H(r){return"$"===r||"@"===r||"_"===r||r>="a"&&r<="z"||r>="A"&&r<="Z"}function V(r){return H(r)||r>="0"&&r<="9"}function Z(r){r.type===j&&q(r,A),q(r,m,r.val)}function q(r,e){var t=Array.prototype.slice.call(arguments,2),n=e.replace(/%(\d)/g,(function(r,e){return t[e]||""})),u=new Error(n);throw u.column=r.range[0],u}return function(u){r=u.split(""),e=0,t=null,n=r.length;var o=O(),i=X();return i.type!==j&&Z(i),o}}(),g=function(){var r,e,t,n;function h(){if(n.length)return n.shift();var r="v"+ ++t;return e.push(r),r}function y(){for(var r=arguments,e=r.length;e--;)n.push(r[e])}function g(e,t,n){if(e.prop){var u=A(e.prop),o=h(),i=h(),a=h(),s=h(),f=h(),p=h(),c=h();r.push(o,"= [];",i,"= 0;",a,"=",n,".length;",c,"= [];","while(",i,"<",a,") {",s,"=",n,"[",i,"++];","if(",s,"!= null) {"),"*"===e.prop?(r.push("if(typeof ",s,'=== "object") {',"if(isArr(",s,")) {",o,"=",o,".concat(",s,");","}","else {","for(",f," in ",s,") {","if(",s,".hasOwnProperty(",f,")) {",p,"=",s,"[",f,"];"),O(o,p),r.push("}","}","}","}")):(r.push(p,"=",s,"[",u,"];"),O(o,p,c,a)),r.push("}","}",t,"=",a,"> 1 &&",c,".length?",c,".length > 1?","concat.apply(",o,",",c,") :",o,".concat(",c,"[0]) :",o,";"),y(o,i,a,s,f,p,c)}}function d(e,t,n){var u=e.prop,o=h(),i=h(),a=h(),s=h(),f=h(),p=h(),c=h(),l=h();r.push(o,"=",n,".slice(),",l,"= [];","while(",o,".length) {",i,"=",o,".shift();"),u?r.push("if(typeof ",i,'=== "object" &&',i,") {"):r.push("if(typeof ",i,"!= null) {"),r.push(a,"= [];","if(isArr(",i,")) {",s,"= 0,",c,"=",i,".length;","while(",s,"<",c,") {",p,"=",i,"[",s,"++];"),u&&r.push("if(typeof ",p,'=== "object") {'),O(a,p),u&&r.push("}"),r.push("}","}","else {"),u?"*"!==u&&(r.push(p,"=",i,'["'+u+'"];'),O(l,p)):(O(l,i),r.push("if(typeof ",i,'=== "object") {')),r.push("for(",f," in ",i,") {","if(",i,".hasOwnProperty(",f,")) {",p,"=",i,"[",f,"];"),O(a,p),"*"===u&&O(l,p),r.push("}","}"),u||r.push("}"),r.push("}",a,".length &&",o,".unshift.apply(",o,",",a,");","}","}",t,"=",l,";"),y(o,i,a,s,f,p,c,l)}function x(e,t,n){var u=h(),o=h(),i=h(),a=h(),s=h();r.push(u,"= [];",o,"= 0;",i,"=",n,".length;","while(",o,"<",i,") {",s,"=",n,"[",o,"++];"),w(e.arg,a,s),r.push(k(e.arg,a),"&&",u,".push(",s,");","}",t,"=",u,";"),y(u,o,i,s,a)}function b(e,t,n){var u,o,i=e.arg;if(i.idx){var a=h();return w(i.idx,a,n),r.push(a,"< 0 && (",a,"=",n,".length +",a,");",t,"=",n,"[",a,"] == null? [] : [",n,"[",a,"]];"),y(a),!1}i.fromIdx?i.toIdx?(w(i.fromIdx,u=h(),n),w(i.toIdx,o=h(),n),r.push(t,"=",n,".slice(",u,",",o,");"),y(u,o)):(w(i.fromIdx,u=h(),n),r.push(t,"=",n,".slice(",u,");"),y(u)):(w(i.toIdx,o=h(),n),r.push(t,"=",n,".slice(0,",o,");"),y(o))}function w(e,t,n){switch(e.type){case u:!function(e,t,n){var u=e.parts,s=0,f=u.length;for(r.push(t,"=",e.fromRoot?"data":e.subst?"subst."+e.subst:n,";","isArr("+t+") || ("+t+" = ["+t+"]);");s<f;){var p=u[s++];switch(p.type){case o:".."===p.selector?d(p,t,t):g(p,t,t);break;case i:x(p,t,t);break;case a:b(p,t,t);break;case c:m(p,t,t)}}}(e,t,n);break;case c:m(e,t,n);break;case f:!function(e,t,n){var o=h(),i=h(),a=h(),s=h(),f=h(),p=h(),c=h(),l=h(),g=e.args[0],d=e.args[1];r.push(t,"= false;"),w(g,o,n),w(d,i,n);var x=g.type===u,b=d.type===v;r.push(a,"="),x?r.push("true;"):r.push("isArr(",o,");"),r.push(s,"="),b?r.push("false;"):r.push("isArr(",i,");"),r.push("if("),x||r.push(a,"&&"),r.push(o,".length === 1) {",o,"=",o,"[0];",a,"= false;","}"),b||r.push("if(",s,"&&",i,".length === 1) {",i,"=",i,"[0];",s,"= false;","}"),r.push(f,"= 0;","if(",a,") {",c,"=",o,".length;"),b||(r.push("if(",s,") {",l,"=",i,".length;","while(",f,"<",c,"&& !",t,") {",p,"= 0;","while(",p,"<",l,") {"),j(e.op,[o,"[",f,"]"].join(""),[i,"[",p,"]"].join("")),r.push(t,"= true;","break;","}","++",p,";","}","++",f,";","}","}","else {"));r.push("while(",f,"<",c,") {"),j(e.op,[o,"[",f,"]"].join(""),i),r.push(t,"= true;","break;","}","++",f,";","}"),b||r.push("}"),r.push("}"),b||(r.push("else if(",s,") {",l,"=",i,".length;","while(",f,"<",l,") {"),j(e.op,o,[i,"[",f,"]"].join("")),r.push(t,"= true;","break;","}","++",f,";","}","}"));r.push("else {",t,"=",_[e.op](o,i),";","}"),y(o,i,a,s,f,p,c,l)}(e,t,n);break;case p:!function(e,t,n){var u=h(),o=h(),i=e.args;w(i[0],u,n),w(i[1],o,n),r.push(t,"=",_[e.op](I(i[0],u),I(i[1],o)),";"),y(u,o)}(e,t,n);break;case s:!function(e,t,n){var u,o=[],i=e.args,a=i.length,s=0;switch(r.push(t,"= false;"),e.op){case"&&":for(;s<a;)o.push(u=h()),w(i[s],u,n),r.push("if(",k(i[s++],u),") {");r.push(t,"= true;");break;case"||":for(;s<a;)o.push(u=h()),w(i[s],u,n),r.push("if(",k(i[s],u),") {",t,"= true;","}"),1+s++<a&&r.push("else {");--a}for(;a--;)r.push("}");y.apply(null,o)}(e,t,n);break;case l:!function(e,t,n){var u=h(),o=e.arg;switch(w(o,u,n),e.op){case"!":r.push(t,"= !",k(o,u)+";");break;case"-":r.push(t,"= -",I(o,u)+";")}y(u)}(e,t,n);break;case v:r.push(t,"="),O=e.val,r.push("string"==typeof O?A(O):null===O?"null":O),r.push(";")}var O}function j(e,t,n){r.push("if(",_[e](t,n),") {")}function m(e,t,n){for(var u=[],o=e.args,i=o.length,a=0;a<i;)u.push(h()),w(o[a],u[a++],n);r.push(t,"= concat.call(",u.join(","),");"),y.apply(null,u)}function A(r){return"'"+r.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"}function O(e,t,n,u){r.push("if(typeof ",t,'!== "undefined") {',"if(isArr(",t,")) {"),n&&(r.push(u,"> 1?"),$(n,t),r.push(":")),r.push(e,"=",e,".length?",e,".concat(",t,") :",t,".slice()",";","}","else {"),n&&r.push("if(",n,".length) {",e,"= concat.apply(",e,",",n,");",n,"= [];","}"),$(e,t),r.push(";","}","}")}function $(e,t){r.push(e,".length?",e,".push(",t,") :",e,"[0] =",t)}function k(r,e){switch(r.type){case s:return e;case v:return"!!"+e;case u:return e+".length > 0";default:return["(typeof ",e,'=== "boolean"?',e,":","isArr(",e,")?",e,".length > 0 : !!",e,")"].join("")}}function I(r,e){switch(r.type){case v:return e;case u:return e+"[0]";default:return["(isArr(",e,")?",e,"[0] : ",e,")"].join("")}}function C(r,e){return["typeof ",r,'=== "string" && typeof ',e,'=== "string" &&',r,".indexOf(",e,") === 0"].join("")}function S(r,e){return[r,"!= null &&",e,"!= null &&",r,".toString().toLowerCase().indexOf(",e,".toString().toLowerCase()) === 0"].join("")}function P(r,e){return["typeof ",r,'=== "string" && typeof ',e,'=== "string" &&',r,".length >=",e,".length &&",r,".lastIndexOf(",e,") ===",r,".length -",e,".length"].join("")}function M(r,e){return[r,"!= null &&",e,"!= null &&","(",r,"=",r,".toString()).length >=","(",e,"=",e,".toString()).length &&","(",r,".toLowerCase()).lastIndexOf(","(",e,".toLowerCase())) ===",r,".length -",e,".length"].join("")}function T(r,e){return["typeof ",r,'=== "string" && typeof ',e,'=== "string" &&',r,".indexOf(",e,") > -1"].join("")}function L(r,e){return[r,"!= null && ",e,"!= null &&",r,".toString().toLowerCase().indexOf(",e,".toString().toLowerCase()) > -1"].join("")}var _={"===":function(r,e){return r+"==="+e},"==":function(r,e){return["typeof ",r,'=== "string" && typeof ',e,'=== "string"?',r,".toLowerCase() ===",e,".toLowerCase() :"+r,"==",e].join("")},">=":function(r,e){return r+">="+e},">":function(r,e){return r+">"+e},"<=":function(r,e){return r+"<="+e},"<":function(r,e){return r+"<"+e},"!==":function(r,e){return r+"!=="+e},"!=":function(r,e){return r+"!="+e},"^==":C,"==^":function(r,e){return C(e,r)},"^=":S,"=^":function(r,e){return S(e,r)},"$==":P,"==$":function(r,e){return P(e,r)},"$=":M,"=$":function(r,e){return M(e,r)},"*==":T,"==*":function(r,e){return T(e,r)},"=*":function(r,e){return L(e,r)},"*=":L,"+":function(r,e){return r+"+"+e},"-":function(r,e){return r+"-"+e},"*":function(r,e){return r+"*"+e},"/":function(r,e){return r+"/"+e},"%":function(r,e){return r+"%"+e}};return function(o){if(r=[],e=["res"],t=0,n=[],w(o,"res","data"),r.unshift("var ",Array.isArray?"isArr = Array.isArray":'toStr = Object.prototype.toString, isArr = function(o) { return toStr.call(o) === "[object Array]"; }',", concat = Array.prototype.concat",",",e.join(","),";"),o.type===u){var i=o.parts[o.parts.length-1];i&&i.type===a&&"idx"in i.arg&&r.push("res = res[0];")}return r.push("return res;"),r.join("")}}();function d(r){return Function("data,subst",g(y(r)))}var x={},b=[],w={cacheSize:100},j={cacheSize:function(r,e){if(e<r&&b.length>e)for(var t=b.splice(0,b.length-e),n=t.length;n--;)delete x[t[n]]}},m=function(r,e,t){return x[r]||(x[r]=d(r),b.push(r)>w.cacheSize&&delete x[b.shift()]),x[r](e,t||{})};m.version="0.3.4",m.params=function(r){if(!arguments.length)return w;for(var e in r)r.hasOwnProperty(e)&&(j[e]&&j[e](w[e],r[e]),w[e]=r[e])},m.compile=d,m.apply=m,"object"==typeof r.exports?r.exports=m:"object"==typeof modules?modules.define("jspath",(function(r){r(m)})):(n=function(r,e,t){t.exports=m}.call(e,t,e,r),void 0===n||(r.exports=n))}()}},e={};function t(n){var u=e[n];if(void 0!==u)return u.exports;var o=e[n]={exports:{}};return r[n](o,o.exports,t),o.exports}t.n=r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return t.d(e,{a:e}),e},t.d=(r,e)=>{for(var n in e)t.o(e,n)&&!t.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},t.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),(()=>{"use strict";var r=t(915),e=t.n(r);function n(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function u(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var o=function(){function r(e){!function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),u(this,"_endpoint","http://xxyy.zz"),u(this,"_converter","AMIXmlToJson.xsl"),this._endpoint=e}var t,o,i;return t=r,(o=[{key:"execute",value:function(r,t){var n=$.Deferred();r=(r||"").trim();var u=(t.endpoint||this._endpoint).trim(),o=(t.converter||this._converter).trim(),i=t.context||n,a=t.timeout||12e4,s=t.extraParam||null,f=t.extraValue||null,p={};p.Command=r,p.Converter=o,s&&(p[s]=f);var c=u,l=u+"?"+$.param(p);return"AMIXmlToJson.xsl"===o?$.ajax({url:c,data:p,type:"POST",timeout:a,dataType:"json",xhrFields:{withCredentials:!0},success:function(r){var t=e().apply(".AMIMessage.info.$",r),u=e().apply(".AMIMessage.error.$",r);0===u.length?n.resolveWith(i,[r,t.join(". "),l]):n.rejectWith(i,[r,u.join(". "),l])},error:function(r,e){"error"===e&&(e="service temporarily unreachable"),"parsererror"===e&&(e="resource temporarily unreachable");var t={AMIMessage:[{error:[{$:e}]}]};n.rejectWith(i,[t,e,l])}}):$.ajax({url:c,data:p,type:"POST",timeout:a,dataType:"text",xhrFields:{withCredentials:!0},success:function(r){n.resolveWith(i,[r,r,l])},error:function(r,e){"error"===e&&(e="service temporarily unreachable"),n.rejectWith(i,[e,e,l])}}),n.promise()}}])&&n(t.prototype,o),i&&n(t,i),r}();"undefined"!=typeof window&&(window.AMIHTTPClient=o)})()})();